 # Event

## 飞行器开机进度

**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** drone_open

**Data:** 

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||
|»progress|进度|struct|  ||
|»»percent|进度百分比|int| {"max":"100","min":"0","step":"1","unit_name":"百分比 / %"} ||
|»»step_key|当前步骤|enum_string| {"close_putter":"闭合推杆","open_drone":"打开无人机"} ||
|need_reply|是否需要回复|enum_int|{"0":"不需要","1":"需要"} ||

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"output": {
			"progress": {
				"percent": 50,
				"step_key": "open_drone"
			},
			"status": "in_progress"
		},
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "drone_open",
	"need_reply": 0
}
```

## 飞行器关机进度

**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** drone_close

**Data:** 

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||
|»progress|进度|struct|  ||
|»»percent|进度百分比|int| {"max":"100","min":"0","step":"1","unit_name":"百分比 / %"} ||
|»»step_key|当前步骤|enum_string| {"close_putter":"闭合推杆","close_drone":"关闭无人机"} ||
|need_reply|是否需要回复|enum_int|{"0":"不需要","1":"需要"} ||

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"output": {
			"progress": {
				"percent": 20,
				"step_key": "close_drone"
			},
			"status": "in_progress"
		},
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "drone_close",
	"need_reply": 0
}
```

## 遥控器开启进度（黑砂独有）

**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** rc_open

**Data:** 

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||
|»progress|进度|struct|  ||
|»»percent|进度百分比|int| {"max":"100","min":"0","step":"1","unit_name":"百分比 / %"} ||
|»»step_key|当前步骤|enum_string| {"turn_on_rc":"打开遥控器"} ||
|need_reply|是否需要回复|enum_int|{"0":"不需要","1":"需要"} ||

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"output": {
			"progress": {
				"percent": 20,
				"step_key": "turn_on_rc"
			},
			"status": "in_progress"
		},
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "rc_open",
	"need_reply": 0
}
```

## 遥控器关闭进度（黑砂独有）

**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** rc_close

**Data:** 

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||
|»progress|进度|struct|  ||
|»»percent|进度百分比|int| {"max":"100","min":"0","step":"1","unit_name":"百分比 / %"} ||
|»»step_key|当前步骤|enum_string| {"turn_off_rc":"关闭遥控器"} ||
|need_reply|是否需要回复|enum_int|{"0":"不需要","1":"需要"} ||

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"output": {
			"progress": {
				"percent": 20,
				"step_key": "turn_off_rc"
			},
			"status": "in_progress"
		},
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "rc_close",
	"need_reply": 0
}
```


## 关闭舱盖进度

**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** cover_close

**Data:** 

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||
|»progress|进度|struct|  ||
|»»percent|进度百分比|int| {"max":"100","min":"0","step":"1","unit_name":"百分比 / %"} ||
|»»step_key|当前步骤|enum_string| {"close_cover":"关闭舱盖"} ||
|need_reply|是否需要回复|enum_int|{"0":"不需要","1":"需要"} ||

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"output": {
			"progress": {
				"percent": 58,
				"step_key": "close_cover"
			},
			"status": "in_progress"
		},
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "cover_close",
	"need_reply": 0
}
```

## 打开舱盖进度



**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** cover_open

**Data:** 

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||
|»progress|进度|struct|  ||
|»»percent|进度百分比|int| {"max":"100","min":"0","step":"1","unit_name":"百分比 / %"} ||
|»»step_key|当前步骤|enum_string| {"open_cover":"打开舱盖"} ||
|need_reply|是否需要回复|enum_int|{"0":"不需要","1":"需要"} ||

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"output": {
			"progress": {
				"percent": 70,
				"step_key": "open_cover"
			},
			"status": "in_progress"
		},
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "cover_open",
	"need_reply": 0
}
```

## 推杆闭合进度



**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** putter_close

**Data:** 

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||
|»progress|进度|struct|  ||
|»»percent|进度百分比|int| {"max":"100","min":"0","step":"1","unit_name":"百分比 / %"} ||
|»»step_key|当前步骤|enum_string| {"close_putter":"闭合推杆"} ||
|need_reply|是否需要回复|enum_int|{"0":"不需要","1":"需要"} ||

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"output": {
			"progress": {
				"percent": 30,
				"step_key": "close_putter"
			},
			"status": "in_progress"
		},
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "putter_close",
	"need_reply": 0
}
```

## 推杆展开进度

**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** putter_open

**Data:** 

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||
|»progress|进度|struct|  ||
|»»percent|进度百分比|int| {"max":"100","min":"0","step":"1","unit_name":"百分比 / %"} ||
|»»step_key|当前步骤|enum_string| {"free_putter":"展开推杆"} ||
|need_reply|是否需要回复|enum_int|{"0":"不需要","1":"需要"} ||


**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"output": {
			"progress": {
				"percent": 80,
				"step_key": "free_putter"
			},
			"status": "in_progress"
		},
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "putter_open",
	"need_reply": 0
}
```


## 打开充电进度

**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** charge_open

**Data:** 

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||
|»progress|进度|struct|  ||
|»»percent|进度百分比|int| {"max":"100","min":"0","step":"1","unit_name":"百分比 / %"} ||
|»»step_key|当前步骤|enum_string| {"close_putter":"闭合推杆","close_drone":"关闭飞行器","start_charge":"开始充电"} ||
|need_reply|是否需要回复|enum_int|{"0":"不需要","1":"需要"} ||


**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"output": {
			"progress": {
				"percent": 15,
				"step_key": "close_putter"
			},
			"status": "in_progress"
		},
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "charge_open",
	"need_reply": 0
}
```


## 关闭充电进度

**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** charge_close

**Data:** 

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||
|»progress|进度|struct|  ||
|»»percent|进度百分比|int| {"max":"100","min":"0","step":"1","unit_name":"百分比 / %"} ||
|»»step_key|当前步骤|enum_string| {"stop_charge":"停止充电"} ||
|need_reply|是否需要回复|enum_int|{"0":"不需要","1":"需要"} ||


**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"output": {
			"progress": {
				"percent": 80,
				"step_key": "stop_charge"
			},
			"status": "in_progress"
		},
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "charge_close",
	"need_reply": 0
}
```





**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** takeoff_to_point_progress

**Data:** 

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|status|任务状态|enum_string| {"task_finish":"一键起飞任务完成","task_ready":"准备起飞","wayline_cancel":"取消飞向目标点","wayline_failed":"执行失败","wayline_ok":"执行成功，已飞向目标点","wayline_progress":"执行中"} ||
|result|返回码|int|  |非 0 代表错误|
|flight_id|一键起飞任务 UUID|text|  ||
|track_id|航迹 ID|text|  ||
|way_point_index|当前执行到第几个航点|int|  ||
|remaining_distance|剩余任务距离|float| {"step":0.1,"unit_name":"米 / m"} ||
|remaining_time|剩余任务时间|float| {"step":0.1,"unit_name":"秒 / s"} ||
|planned_path_points|规划的轨迹点列表|array|  {"size": -, "item_type": struct}  ||
|»latitude|轨迹点纬度|double| {"max":90,"min":-90} |轨迹点纬度，角度值，南纬是负，北纬是正，精度到小数点后6位|
|»longitude|轨迹点经度|double| {"max":180,"min":-180} |轨迹点经度，角度值，东经是正，西经是负，精度到小数点后6位|
|»height|轨迹点高度|float| {"step":0.1,"unit_name":"米 / m"} |轨迹点高度，椭球高|


**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"flight_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
		"planned_path_points": [
			{
				"height": 123.234,
				"latitude": 13.23,
				"longitude": 123.234
			}
		],
		"remaining_distance": 0,
		"remaining_time": 0,
		"result": 0,
		"status": "wayline_ok",
		"track_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
		"way_point_index": 1
	},
	"need_reply": 1,
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 16540709686556,
	"method": "takeoff_to_point_progress"
}
```








 # Service

## 飞行器开机



**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** drone_open

**Data:** null 



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** drone_open

**Data:**

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||


## 飞行器关机

**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** drone_close

**Data:** null 



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** drone_close

**Data:**

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||

## 遥控器开机（黑砂独有）

**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** rc_open

**Data:** null 



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** rc_open

**Data:**

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||

## 遥控器关机（黑砂独有）

**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** rc_close

**Data:** null 



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** rc_close

**Data:**

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||



## 打开舱盖



**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** cover_open

**Data:** null 



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** cover_open

**Data:**

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||


## 关闭舱盖



**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** cover_close

**Data:** null 



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** cover_close

**Data:**

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||


## 推杆展开



**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** putter_open

**Data:** null 



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** putter_open

**Data:**

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  ||
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||


## 推杆闭合



**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** putter_close

**Data:** null 



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** putter_close

**Data:**

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  ||
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||


## 打开充电



**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** charge_open

**Data:** null 



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** charge_open

**Data:**

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||

## 关闭充电


**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** charge_close

**Data:** null 



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** charge_close

**Data:**

|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int|  |非 0 代表错误|
|output|输出|struct|  ||
|»status|任务状态|enum_string| {"canceled":"取消或终止","failed":"失败","in_progress":"执行中","ok":"执行成功","paused":"暂停","rejected":"拒绝","sent":"已下发","timeout":"超时"} ||

